<div class="reset-password-container">

    <div class="form-card" *ngIf="errorMessage && !isSuccess">
        <mat-icon class="error-icon">error</mat-icon>
        <h1 class="title">Invalid Link</h1>
        <p class="description">{{ errorMessage }}</p>
        <a mat-stroked-button routerLink="/forgot-password">Request a new link</a>
    </div>

    <div class="form-card" *ngIf="!errorMessage && !isSuccess">
        <h1 class="title">Set a New Password</h1>
        <p class="description">Your new password must be at least 6 characters long.</p>

        <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()">
            <mat-form-field appearance="outline" class="full-width">
                <mat-label>New Password</mat-label>
                <input matInput formControlName="newPassword" type="password">
                <mat-error *ngIf="resetPasswordForm.get('newPassword')?.hasError('required')">
                    Password is required
                </mat-error>
                <mat-error *ngIf="resetPasswordForm.get('newPassword')?.hasError('minlength')">
                    Password must be at least 6 characters long
                </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width">
                <mat-label>Confirm New Password</mat-label>
                <input matInput formControlName="confirmPassword" type="password">
                <mat-error *ngIf="resetPasswordForm.get('confirmPassword')?.hasError('required')">
                    Please confirm your password
                </mat-error>
                <mat-error
                    *ngIf="resetPasswordForm.hasError('passwordsMismatch') && resetPasswordForm.get('confirmPassword')?.dirty">
                    Passwords do not match
                </mat-error>
            </mat-form-field>

            <button mat-raised-button color="primary" type="submit" [disabled]="isLoading || resetPasswordForm.invalid"
                class="full-width">
                <mat-spinner *ngIf="isLoading" diameter="20"></mat-spinner>
                <span *ngIf="!isLoading">Reset Password</span>
            </button>
        </form>
    </div>

    <div class="success-card" *ngIf="isSuccess">
        <mat-icon class="success-icon">check_circle</mat-icon>
        <h1 class="title">Password Reset!</h1>
        <p class="description">
            Your password has been successfully reset. You can now log in with your new password.
        </p>
        <a mat-raised-button color="primary" routerLink="/login">Go to Login</a>
    </div>
</div>